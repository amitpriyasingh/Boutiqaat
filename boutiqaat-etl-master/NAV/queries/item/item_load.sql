BEGIN;
DROP TABLE IF EXISTS tmp_item;
CREATE TEMP TABLE tmp_item(
	ts VARCHAR(40),
	no VARCHAR(20),
	no_2 VARCHAR(40),
	description VARCHAR(200),
	search_description VARCHAR(200),
	description_2 VARCHAR(200),
	base_unit_of_measure VARCHAR(10),
	price_unit_conversion INTEGER,
	type INTEGER,
	inventory_posting_group VARCHAR(10),
	shelf_no VARCHAR(10),
	item_disc_group VARCHAR(20),
	allow_invoice_disc SMALLINT,
	statistics_group INTEGER,
	commission_group INTEGER,
	unit_price DECIMAL(38,20),
	price_profit_calculation INTEGER,
	profit DECIMAL(38,20),
	costing_method INTEGER,
	unit_cost DECIMAL(38,20),
	standard_cost DECIMAL(38,20),
	last_direct_cost DECIMAL(38,20),
	indirect_cost_ DECIMAL(38,20),
	cost_is_adjusted SMALLINT,
	allow_online_adjustment SMALLINT,
	vendor_no VARCHAR(20),
	vendor_item_no VARCHAR(20),
	lead_time_calculation VARCHAR(32),
	reorder_point DECIMAL(38,20),
	maximum_inventory DECIMAL(38,20),
	reorder_quantity DECIMAL(38,20),
	alternative_item_no VARCHAR(20),
	unit_list_price DECIMAL(38,20),
	duty_due DECIMAL(38,20),
	duty_code VARCHAR(10),
	gross_weight DECIMAL(38,20),
	net_weight DECIMAL(38,20),
	units_per_parcel DECIMAL(38,20),
	unit_volume DECIMAL(38,20),
	durability VARCHAR(10),
	freight_type VARCHAR(10),
	tariff_no VARCHAR(20),
	duty_unit_conversion DECIMAL(38,20),
	country_region_purchased_code VARCHAR(10),
	budget_quantity DECIMAL(38,20),
	budgeted_amount DECIMAL(38,20),
	budget_profit DECIMAL(38,20),
	blocked SMALLINT,
	last_date_modified TIMESTAMP,
	last_time_modified TIMESTAMP,
	price_includes_vat SMALLINT,
	vat_bus_posting_gr_price VARCHAR(10),
	gen_prod_posting_group VARCHAR(10),
	country_region_of_origin_code VARCHAR(10),
	automatic_ext_texts SMALLINT,
	no_series VARCHAR(10),
	tax_group_code VARCHAR(10),
	vat_prod_posting_group VARCHAR(10),
	reserve INTEGER,
	global_dimension_1_code VARCHAR(20),
	global_dimension_2_code VARCHAR(20),
	stockout_warning INTEGER,
	prevent_negative_inventory INTEGER,
	application_wksh_user_id VARCHAR(128),
	assembly_policy INTEGER,
	gtin VARCHAR(14),
	default_deferral_template_code VARCHAR(10),
	low_level_code INTEGER,
	lot_size DECIMAL(38,20),
	serial_nos VARCHAR(10),
	last_unit_cost_calc_date TIMESTAMP,
	rolled_up_material_cost DECIMAL(38,20),
	rolled_up_capacity_cost DECIMAL(38,20),
	scrap DECIMAL(38,20),
	inventory_value_zero SMALLINT,
	discrete_order_quantity INTEGER,
	minimum_order_quantity DECIMAL(38,20),
	maximum_order_quantity DECIMAL(38,20),
	safety_stock_quantity DECIMAL(38,20),
	order_multiple DECIMAL(38,20),
	safety_lead_time VARCHAR(32),
	flushing_method INTEGER,
	replenishment_system INTEGER,
	rounding_precision DECIMAL(38,20),
	sales_unit_of_measure VARCHAR(10),
	purch_unit_of_measure VARCHAR(10),
	time_bucket VARCHAR(32),
	reordering_policy INTEGER,
	include_inventory SMALLINT,
	manufacturing_policy INTEGER,
	rescheduling_period VARCHAR(32),
	lot_accumulation_period VARCHAR(32),
	dampener_period VARCHAR(32),
	dampener_quantity DECIMAL(38,20),
	overflow_level DECIMAL(38,20),
	manufacturer_code VARCHAR(10),
	item_category_code VARCHAR(20),
	created_from_nonstock_item SMALLINT,
	product_group_code VARCHAR(20),
	service_item_group VARCHAR(10),
	item_tracking_code VARCHAR(10),
	lot_nos VARCHAR(10),
	expiration_calculation VARCHAR(32),
	warehouse_class_code VARCHAR(10),
	special_equipment_code VARCHAR(10),
	put_away_template_code VARCHAR(10),
	put_away_unit_of_measure_code VARCHAR(10),
	phys_invt_counting_period_code VARCHAR(10),
	last_counting_period_update TIMESTAMP,
	use_cross_docking SMALLINT,
	next_counting_start_date TIMESTAMP,
	next_counting_end_date TIMESTAMP,
	third_category VARCHAR(40),
	fourth_category VARCHAR(40),
	brand VARCHAR(20),
	color VARCHAR(20),
	size VARCHAR(20),
	power VARCHAR(20),
	thickness DECIMAL(38,20),
	diameter DECIMAL(38,20),
	packaging VARCHAR(20),
	default_zone_codes VARCHAR(100),
	default_bin_codes VARCHAR(100),
	flavour VARCHAR(20),
	gender INTEGER,
	class VARCHAR(20),
	material VARCHAR(20),
	ean_code VARCHAR(30),
	arabic_name VARCHAR(500),
	created_at TIMESTAMP,
	created_by VARCHAR(50),
	expiry_lead_time VARCHAR(32),
	expiry_required SMALLINT,
	cost_standard DECIMAL(38,20),
	cost_labour DECIMAL(38,20),
	cost_overhead DECIMAL(38,20),
	cost_machine_hours DECIMAL(38,20),
	cost_other_1 DECIMAL(38,20),
	cost_other_2 DECIMAL(38,20),
	cost_other_3 DECIMAL(38,20),
	status INTEGER,
	item_type INTEGER,
	parent_item_no_ VARCHAR(20),
	item_sub_type INTEGER,
	attribute_value VARCHAR(250),
	item_contract_type INTEGER,
	ref_doc_number VARCHAR(20),
	ref_doc_line_no INTEGER,
	cost_price_calculation INTEGER,
	sync SMALLINT,
	synced_datetime TIMESTAMP,
	sync_id VARCHAR(20),
	error_message VARCHAR(250),
	retry_count INTEGER,
	inventory_live SMALLINT,
	sync_with_magento INTEGER,
	returnable SMALLINT,
	template_code VARCHAR(20),
	item_enabled SMALLINT,
	is_dangerous INTEGER,
	is_fragile INTEGER,
	ofs_sync SMALLINT,
	ofs_retry_count INTEGER,
	ofs_error_message VARCHAR(100),
	ofs_sync_date_time TIMESTAMP,
	magento_sync_id INTEGER,
	bin_size INTEGER,
	wms_sync SMALLINT,
	wms_retry_count INTEGER,
	wms_error_message VARCHAR(100),
	routing_no VARCHAR(20),
	production_bom_no VARCHAR(20),
	single_level_material_cost DECIMAL(38,20),
	single_level_capacity_cost DECIMAL(38,20),
	single_level_subcontrd_cost DECIMAL(38,20),
	single_level_cap_ovhd_cost DECIMAL(38,20),
	single_level_mfg_ovhd_cost DECIMAL(38,20),
	overhead_rate DECIMAL(38,20),
	rolled_up_subcontracted_cost DECIMAL(38,20),
	rolled_up_mfg_ovhd_cost DECIMAL(38,20),
	rolled_up_cap_overhead_cost DECIMAL(38,20),
	order_tracking_policy INTEGER,
	critical SMALLINT,
	common_item_no VARCHAR(20),
	department VARCHAR(50),
	category_manager VARCHAR(50)
);

copy tmp_item from '{{S3PATH}}'
iam_role 'arn:aws:iam::652586300051:role/Redshift-athena-S3-readonly'
delimiter '\t'
region 'eu-west-1' 
acceptinvchars
CSV 
GZIP
emptyasnull
blanksasnull
NULL AS 'null';


DROP TABLE IF EXISTS NAV.item;
CREATE TABLE NAV.item (
	ts VARCHAR(40),
	no VARCHAR(20),
	no_2 VARCHAR(40),
	description VARCHAR(200),
	search_description VARCHAR(200),
	description_2 VARCHAR(200),
	base_unit_of_measure VARCHAR(10),
	price_unit_conversion INTEGER,
	type INTEGER,
	inventory_posting_group VARCHAR(10),
	shelf_no VARCHAR(10),
	item_disc_group VARCHAR(20),
	allow_invoice_disc SMALLINT,
	statistics_group INTEGER,
	commission_group INTEGER,
	unit_price DECIMAL(38,20),
	price_profit_calculation INTEGER,
	profit DECIMAL(38,20),
	costing_method INTEGER,
	unit_cost DECIMAL(38,20),
	standard_cost DECIMAL(38,20),
	last_direct_cost DECIMAL(38,20),
	indirect_cost_ DECIMAL(38,20),
	cost_is_adjusted SMALLINT,
	allow_online_adjustment SMALLINT,
	vendor_no VARCHAR(20),
	vendor_item_no VARCHAR(20),
	lead_time_calculation VARCHAR(32),
	reorder_point DECIMAL(38,20),
	maximum_inventory DECIMAL(38,20),
	reorder_quantity DECIMAL(38,20),
	alternative_item_no VARCHAR(20),
	unit_list_price DECIMAL(38,20),
	duty_due DECIMAL(38,20),
	duty_code VARCHAR(10),
	gross_weight DECIMAL(38,20),
	net_weight DECIMAL(38,20),
	units_per_parcel DECIMAL(38,20),
	unit_volume DECIMAL(38,20),
	durability VARCHAR(10),
	freight_type VARCHAR(10),
	tariff_no VARCHAR(20),
	duty_unit_conversion DECIMAL(38,20),
	country_region_purchased_code VARCHAR(10),
	budget_quantity DECIMAL(38,20),
	budgeted_amount DECIMAL(38,20),
	budget_profit DECIMAL(38,20),
	blocked SMALLINT,
	last_date_modified TIMESTAMP,
	last_time_modified TIMESTAMP,
	price_includes_vat SMALLINT,
	vat_bus_posting_gr_price VARCHAR(10),
	gen_prod_posting_group VARCHAR(10),
	country_region_of_origin_code VARCHAR(10),
	automatic_ext_texts SMALLINT,
	no_series VARCHAR(10),
	tax_group_code VARCHAR(10),
	vat_prod_posting_group VARCHAR(10),
	reserve INTEGER,
	global_dimension_1_code VARCHAR(20),
	global_dimension_2_code VARCHAR(20),
	stockout_warning INTEGER,
	prevent_negative_inventory INTEGER,
	application_wksh_user_id VARCHAR(128),
	assembly_policy INTEGER,
	gtin VARCHAR(14),
	default_deferral_template_code VARCHAR(10),
	low_level_code INTEGER,
	lot_size DECIMAL(38,20),
	serial_nos VARCHAR(10),
	last_unit_cost_calc_date TIMESTAMP,
	rolled_up_material_cost DECIMAL(38,20),
	rolled_up_capacity_cost DECIMAL(38,20),
	scrap DECIMAL(38,20),
	inventory_value_zero SMALLINT,
	discrete_order_quantity INTEGER,
	minimum_order_quantity DECIMAL(38,20),
	maximum_order_quantity DECIMAL(38,20),
	safety_stock_quantity DECIMAL(38,20),
	order_multiple DECIMAL(38,20),
	safety_lead_time VARCHAR(32),
	flushing_method INTEGER,
	replenishment_system INTEGER,
	rounding_precision DECIMAL(38,20),
	sales_unit_of_measure VARCHAR(10),
	purch_unit_of_measure VARCHAR(10),
	time_bucket VARCHAR(32),
	reordering_policy INTEGER,
	include_inventory SMALLINT,
	manufacturing_policy INTEGER,
	rescheduling_period VARCHAR(32),
	lot_accumulation_period VARCHAR(32),
	dampener_period VARCHAR(32),
	dampener_quantity DECIMAL(38,20),
	overflow_level DECIMAL(38,20),
	manufacturer_code VARCHAR(10),
	item_category_code VARCHAR(20),
	created_from_nonstock_item SMALLINT,
	product_group_code VARCHAR(20),
	service_item_group VARCHAR(10),
	item_tracking_code VARCHAR(10),
	lot_nos VARCHAR(10),
	expiration_calculation VARCHAR(32),
	warehouse_class_code VARCHAR(10),
	special_equipment_code VARCHAR(10),
	put_away_template_code VARCHAR(10),
	put_away_unit_of_measure_code VARCHAR(10),
	phys_invt_counting_period_code VARCHAR(10),
	last_counting_period_update TIMESTAMP,
	use_cross_docking SMALLINT,
	next_counting_start_date TIMESTAMP,
	next_counting_end_date TIMESTAMP,
	third_category VARCHAR(40),
	fourth_category VARCHAR(40),
	brand VARCHAR(20),
	color VARCHAR(20),
	size VARCHAR(20),
	power VARCHAR(20),
	thickness DECIMAL(38,20),
	diameter DECIMAL(38,20),
	packaging VARCHAR(20),
	default_zone_codes VARCHAR(100),
	default_bin_codes VARCHAR(100),
	flavour VARCHAR(20),
	gender INTEGER,
	class VARCHAR(20),
	material VARCHAR(20),
	ean_code VARCHAR(30),
	arabic_name VARCHAR(500),
	created_at TIMESTAMP,
	created_by VARCHAR(50),
	expiry_lead_time VARCHAR(32),
	expiry_required SMALLINT,
	cost_standard DECIMAL(38,20),
	cost_labour DECIMAL(38,20),
	cost_overhead DECIMAL(38,20),
	cost_machine_hours DECIMAL(38,20),
	cost_other_1 DECIMAL(38,20),
	cost_other_2 DECIMAL(38,20),
	cost_other_3 DECIMAL(38,20),
	status INTEGER,
	item_type INTEGER,
	parent_item_no_ VARCHAR(20),
	item_sub_type INTEGER,
	attribute_value VARCHAR(250),
	item_contract_type INTEGER,
	ref_doc_number VARCHAR(20),
	ref_doc_line_no INTEGER,
	cost_price_calculation INTEGER,
	sync SMALLINT,
	synced_datetime TIMESTAMP,
	sync_id VARCHAR(20),
	error_message VARCHAR(250),
	retry_count INTEGER,
	inventory_live SMALLINT,
	sync_with_magento INTEGER,
	returnable SMALLINT,
	template_code VARCHAR(20),
	item_enabled SMALLINT,
	is_dangerous INTEGER,
	is_fragile INTEGER,
	ofs_sync SMALLINT,
	ofs_retry_count INTEGER,
	ofs_error_message VARCHAR(100),
	ofs_sync_date_time TIMESTAMP,
	magento_sync_id INTEGER,
	bin_size INTEGER,
	wms_sync SMALLINT,
	wms_retry_count INTEGER,
	wms_error_message VARCHAR(100),
	routing_no VARCHAR(20),
	production_bom_no VARCHAR(20),
	single_level_material_cost DECIMAL(38,20),
	single_level_capacity_cost DECIMAL(38,20),
	single_level_subcontrd_cost DECIMAL(38,20),
	single_level_cap_ovhd_cost DECIMAL(38,20),
	single_level_mfg_ovhd_cost DECIMAL(38,20),
	overhead_rate DECIMAL(38,20),
	rolled_up_subcontracted_cost DECIMAL(38,20),
	rolled_up_mfg_ovhd_cost DECIMAL(38,20),
	rolled_up_cap_overhead_cost DECIMAL(38,20),
	order_tracking_policy INTEGER,
	critical SMALLINT,
	common_item_no VARCHAR(20),
	department VARCHAR(50),
	category_manager VARCHAR(50)
);


INSERT INTO NAV.item
SELECT ts,no,no_2,description,search_description,description_2,base_unit_of_measure,price_unit_conversion,type,inventory_posting_group,shelf_no,item_disc_group,allow_invoice_disc,statistics_group,commission_group,unit_price,price_profit_calculation,profit,costing_method,unit_cost,standard_cost,last_direct_cost,indirect_cost_,cost_is_adjusted,allow_online_adjustment,vendor_no,vendor_item_no,lead_time_calculation,reorder_point,maximum_inventory,reorder_quantity,alternative_item_no,unit_list_price,duty_due,duty_code,gross_weight,net_weight,units_per_parcel,unit_volume,durability,freight_type,tariff_no,duty_unit_conversion,country_region_purchased_code,budget_quantity,budgeted_amount,budget_profit,blocked,last_date_modified,last_time_modified,price_includes_vat,vat_bus_posting_gr_price,gen_prod_posting_group,country_region_of_origin_code,automatic_ext_texts,no_series,tax_group_code,vat_prod_posting_group,reserve,global_dimension_1_code,global_dimension_2_code,stockout_warning,prevent_negative_inventory,application_wksh_user_id,assembly_policy,gtin,default_deferral_template_code,low_level_code,lot_size,serial_nos,last_unit_cost_calc_date,rolled_up_material_cost,rolled_up_capacity_cost,scrap,inventory_value_zero,discrete_order_quantity,minimum_order_quantity,maximum_order_quantity,safety_stock_quantity,order_multiple,safety_lead_time,flushing_method,replenishment_system,rounding_precision,sales_unit_of_measure,purch_unit_of_measure,time_bucket,reordering_policy,include_inventory,manufacturing_policy,rescheduling_period,lot_accumulation_period,dampener_period,dampener_quantity,overflow_level,manufacturer_code,item_category_code,created_from_nonstock_item,product_group_code,service_item_group,item_tracking_code,lot_nos,expiration_calculation,warehouse_class_code,special_equipment_code,put_away_template_code,put_away_unit_of_measure_code,phys_invt_counting_period_code,last_counting_period_update,use_cross_docking,next_counting_start_date,next_counting_end_date,third_category,fourth_category,brand,color,size,power,thickness,diameter,packaging,default_zone_codes,default_bin_codes,flavour,gender,class,material,ean_code,arabic_name,created_at,created_by,expiry_lead_time,expiry_required,cost_standard,cost_labour,cost_overhead,cost_machine_hours,cost_other_1,cost_other_2,cost_other_3,status,item_type,parent_item_no_,item_sub_type,attribute_value,item_contract_type,ref_doc_number,ref_doc_line_no,cost_price_calculation,sync,synced_datetime,sync_id,error_message,retry_count,inventory_live,sync_with_magento,returnable,template_code,item_enabled,is_dangerous,is_fragile,ofs_sync,ofs_retry_count,ofs_error_message,ofs_sync_date_time,magento_sync_id,bin_size,wms_sync,wms_retry_count,wms_error_message,routing_no,production_bom_no,single_level_material_cost,single_level_capacity_cost,single_level_subcontrd_cost,single_level_cap_ovhd_cost,single_level_mfg_ovhd_cost,overhead_rate,rolled_up_subcontracted_cost,rolled_up_mfg_ovhd_cost,rolled_up_cap_overhead_cost,order_tracking_policy,critical,common_item_no,department,category_manager
FROM tmp_item;
COMMIT;