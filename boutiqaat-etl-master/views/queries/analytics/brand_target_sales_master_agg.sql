CREATE OR REPLACE VIEW analytics.brand_target_sales_master_agg AS
SELECT brand_target_sales_master_details.traget_month, brand_target_sales_master_details.brand_target_owner, brand_target_sales_master_details.brand_target_owner_email, brand_target_sales_master_details.brand_target_owner_type, brand_target_sales_master_details.brand, brand_target_sales_master_details.celebrity_name, brand_target_sales_master_details.mtd_target, brand_target_sales_master_details.total_target, brand_target_sales_master_details.mtd_sale, brand_target_sales_master_details.monthly_projected_sale, brand_target_sales_master_details.mtd_achievement, brand_target_sales_master_details.monthly_projected_achievement, CASE WHEN ((brand_target_sales_master_details.mtd_achievement > (1)::numeric(10,3)) AND ((brand_target_sales_master_details.brand_target_owner_type)::text = 'am'::text)) THEN 200 WHEN ((brand_target_sales_master_details.mtd_achievement > (1)::numeric(10,3)) AND ((brand_target_sales_master_details.brand_target_owner_type)::text = 'rm'::text)) THEN 265 ELSE 0 END AS mtd_commission, CASE WHEN ((brand_target_sales_master_details.monthly_projected_achievement > (1)::numeric(10,3)) AND ((brand_target_sales_master_details.brand_target_owner_type)::text = 'am'::text)) THEN 200 WHEN ((brand_target_sales_master_details.monthly_projected_achievement > (1)::numeric(10,3)) AND ((brand_target_sales_master_details.brand_target_owner_type)::text = 'rm'::text)) THEN 265 ELSE 0 END AS projected_commission FROM aoi.brand_target_sales_master_details
WITH NO SCHEMA BINDING;