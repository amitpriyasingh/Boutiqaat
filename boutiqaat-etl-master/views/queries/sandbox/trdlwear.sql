CREATE OR REPLACE VIEW sandbox.trdlwear AS
SELECT inventory_health.sku, inventory_health.barcode, inventory_health.sku_name, inventory_health.brand, inventory_health.department, inventory_health.category1, inventory_health.vendor_code, inventory_health.supplier, inventory_health.first_grn_date, inventory_health.first_order_date, inventory_health.soh, inventory_health.open_po_qty, inventory_health.sold_qty_14days, inventory_health.sold_qty_30_days, inventory_health.sold_qty_60_days, inventory_health.sold_qty_90_days, inventory_health.sold_qty_180_days, inventory_health.lifetime_sold_qty, inventory_health.stock_cover_flag, inventory_health.inventory_category, inventory_health.stock_cover_60days_sale_basis, round((((inventory_health.stock_cover_60days_sale_basis)::numeric)::numeric(8,2) * (30.42)::numeric(8,2)), 0) AS stock_cover_days, CASE WHEN (round((((inventory_health.stock_cover_60days_sale_basis)::numeric)::numeric(8,2) * (30.42)::numeric(8,2)), 0) <= (10)::numeric) THEN 'Cover between 0 to 10 Days'::text WHEN (round((((inventory_health.stock_cover_60days_sale_basis)::numeric)::numeric(8,2) * (30.42)::numeric(8,2)), 0) <= (20)::numeric) THEN 'Cover between 11 to 20 Days'::text WHEN (round((((inventory_health.stock_cover_60days_sale_basis)::numeric)::numeric(8,2) * (30.42)::numeric(8,2)), 0) <= (30)::numeric) THEN 'Cover between 21 to30 Days'::text WHEN (round((((inventory_health.stock_cover_60days_sale_basis)::numeric)::numeric(8,2) * (30.42)::numeric(8,2)), 0) <= (45)::numeric) THEN 'Cover between 31 to 45 Days'::text ELSE 'Cover between 46 and 60 Days'::text END AS stock_cover_day FROM aoi.inventory_health WHERE (((((inventory_health.stock_cover_flag)::text = 'Low_Cover'::text) OR ((inventory_health.stock_cover_flag)::text = 'Normal_Cover'::text)) AND ((inventory_health.stock_cover_60days_sale_basis)::text <= (2)::text)) AND (((inventory_health.department)::text = 'TRDLWEAR'::text) OR (inventory_health.department IS NULL))) GROUP BY inventory_health.sku, inventory_health.barcode, inventory_health.sku_name, inventory_health.brand, inventory_health.department, inventory_health.category1, inventory_health.vendor_code, inventory_health.supplier, inventory_health.first_grn_date, inventory_health.first_order_date, inventory_health.soh, inventory_health.open_po_qty, inventory_health.sold_qty_14days, inventory_health.sold_qty_30_days, inventory_health.sold_qty_60_days, inventory_health.sold_qty_90_days, inventory_health.sold_qty_180_days, inventory_health.lifetime_sold_qty, inventory_health.stock_cover_flag, inventory_health.inventory_category, inventory_health.stock_cover_60days_sale_basis, round((((inventory_health.stock_cover_60days_sale_basis)::numeric)::numeric(8,2) * (30.42)::numeric(8,2)), 0)
WITH NO SCHEMA BINDING;